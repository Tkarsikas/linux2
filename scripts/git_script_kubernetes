
cd ~/linux2
git pull
cp /home/ubuntu/linux2/scripts/git_script_kubernetes /home/ubuntu/scripts/
echo "git pull done, script copied"
cp /home/ubuntu/linux2/kubernetes/nginx-pod.yaml /home/ubuntu/kubernetes/
cp /home/ubuntu/linux2/kubernetes/backend-configmap.yaml /home/ubuntu/kubernetes/
cp /home/ubuntu/linux2/kubernetes/backend-deployment.yaml /home/ubuntu/kubernetes/
cp /home/ubuntu/linux2/kubernetes/frontend-deployment.yaml /home/ubuntu/kubernetes/
cp /home/ubuntu/linux2/kubernetes/mysql-deployment.yaml /home/ubuntu/kubernetes/
cp /home/ubuntu/linux2/kubernetes/mysql-pvc.yaml /home/ubuntu/kubernetes/
echo "kubernetes root files copied"
cp -r /home/ubuntu/linux2/kubernetes/backend /home/ubuntu/kubernetes/
echo "backend directory copied"
cp -r /home/ubuntu/linux2/kubernetes/frontend /home/ubuntu/kubernetes/
echo "frontend directory copied"
sudo cp /home/ubuntu/linux2/lemp-app /etc/nginx/sites-available
echo "lemp-app copied to nginx sites-available"
sudo systemctl reload nginx


cd ~/kubernetes
eval $(minikube docker-env)
cd backend
docker build -t backend:latest .

cd ../frontend
docker build -t frontend:latest .

kubectl rollout restart deployment/backend
kubectl rollout restart deployment/frontend
echo "kubernetes deployments restarted"
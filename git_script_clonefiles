
cd ~
if [ -z "$VIRTUAL_ENV" ]; then
    #echo "Virtuaaliympäristö ei ole aktivoitu. Aktivoidaan nyt..."
    cd ~/lemp-app || { echo "Kansion vaihtaminen epäonnistui"; exit 1; }
    source venv/bin/activate
    echo "Virtuaaliympäristö aktivoitu."
else
    echo "Virtuaaliympäristö on jo aktivoitu: $VIRTUAL_ENV"
fi
cd ~
cd linux2
git pull origin main
cp /home/ubuntu/linux2/app.py /home/ubuntu/lemp-app
cp -r /home/ubuntu/linux2/templates /home/ubuntu/lemp-app

sudo cp /home/ubuntu/linux2/lemp-app /etc/nginx/sites-available
cp /home/ubuntu/linux2/git_script_clonefiles /home/ubuntu/
sudo cp /home/ubuntu/linux2/lemp-app.service /etc/systemd/system/
cp /home/ubuntu/linux2/requirements.txt /home/ubuntu/streamlitapp/.streamlit
sudo cp /home/ubuntu/linux2/streamlit.service /etc/systemd/system/
cp /home/ubuntu/linux2/streamlitapp.py /home/ubuntu/streamlitapp/
cp /home/ubuntu/linux2/config.toml /home/ubuntu/streamlitapp/.streamlit/

cp /home/ubuntu/linux2/cron_assignment/fetch_weather.py /home/ubuntu/cron_assignment/
cp /home/ubuntu/linux2/cron_assignment/fetch_weather.sh /home/ubuntu/cron_assignment/


echo "Files copied"
cd
sudo systemctl reload nginx
sudo systemctl daemon-reload
sudo systemctl restart lemp-app
sudo systemctl restart streamlit

echo "Service restarted"